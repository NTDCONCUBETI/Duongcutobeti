local remote = game:GetService("ReplicatedStorage")
	:WaitForChild("Shared")
	:WaitForChild("Remotes")
	:WaitForChild("Networking")
	:WaitForChild("RF/PlotAction")

local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local rootPart = character:WaitForChild("HumanoidRootPart")
local bases = workspace:WaitForChild("Bases")
local My_plot = nil

--########################################## L·∫•y ƒë·ªãa ch·ªâ nh√†
for _, plot in ipairs(bases:GetChildren()) do
	local title = plot:FindFirstChild("Title")
	if title then
		local titleGui = title:FindFirstChild("TitleGui")
		if titleGui then
			local frame = titleGui:FindFirstChild("Frame")
			if frame then
				local playerNameLabel = frame:FindFirstChild("PlayerName")
				if playerNameLabel and playerNameLabel:IsA("TextLabel") then
					if playerNameLabel.Text == player.DisplayName then
						My_plot = plot
						break
					end
				end
			end
		end
	end
end

--##########################################Thu ti·ªÅn
-- üîπ L·∫•y t·∫•t c·∫£ floor v√† s·∫Øp x·∫øp theo s·ªë
local floors = {}

for _, child in ipairs(My_plot:GetChildren()) do
	local number = tonumber(child.Name:match("^Floor(%d+)$"))
	if number then
		table.insert(floors, {object = child, index = number})
	end
end

table.sort(floors, function(a, b)
	return a.index < b.index
end)

-- üîπ B·∫Øt ƒë·∫ßu collect
local currentIndex = 1

for _, data in ipairs(floors) do
	local primary = data.object:FindFirstChild("Primary")

	if primary then
		-- Teleport l√™n floor
		character:PivotTo(CFrame.new(primary.Position + Vector3.new(0,3,0)))
		task.wait(0.5)

		-- Collect 10 l·∫ßn m·ªói floor
		for _ = 1, 10 do
			remote:InvokeServer("Collect Money", My_plot.Name, tostring(currentIndex))
			currentIndex += 1
			task.wait(0.5)
		end
	end
end

--V·ªÅ l·∫°i t√¢ng 1
character:PivotTo(CFrame.new(My_plot:FindFirstChild("Spawn").Position + Vector3.new(0,3,0)))
