getgenv().autoDigsiteConfig = {
    DIGSITE_RESET_DELAY = 10, -- Amount of time in seconds to wait before starting the script back up after the digsite resets
    LOAD_DELAY = 5,
    CHEST_BREAK_DELAY = 0.1, -- Amount of time in seconds to wait before breaking a chest
    DIG_DEPTH = 1,
    UNBROKEN_BLOCK_THRESHOLD = 100
}

local digsiteReset = false

local positions = {
    [1] = Vector3.new(10, 1, 10),

}

local function checkForChests()
    for _, v in pairs(game:GetService("Workspace").__THINGS.__INSTANCE_CONTAINER.Active.AdvancedDigsite.Important.ActiveChests:GetChildren()) do
        if v:IsA("Model") then
            pcall(function()
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v.Top.CFrame
                task.wait(getgenv().autoDigsiteConfig.CHEST_BREAK_DELAY)
                game:GetService("ReplicatedStorage").Network:WaitForChild("Instancing_FireCustomFromClient"):FireServer("AdvancedDigsite", "DigChest", v:GetAttribute('Coord'))
                v:Destroy()
                task.wait()
            end)
        end
    end
end




                    for i = 0, getgenv().autoDigsiteConfig.DIG_DEPTH do
                        checkForChests()
                        digBlock(i)
                        task.wait()
                    end
                end
            end
        end
    end
    print("Finished Cycle... Digging until reset")

    while not digsiteReset do
        for _, v in pairs(game:GetService("Workspace").__THINGS.__INSTANCE_CONTAINER.Active.AdvancedDigsite.Important.ActiveBlocks:GetChildren()) do
            if v:IsA("Part") then
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v.CFrame + Vector3.new(0, 3, 0)

                local counter = 0
                local function digBlock()

                    if counter < getgenv().autoDigsiteConfig.UNBROKEN_BLOCK_THRESHOLD then

                        local block
                        for _, v2 in pairs(game:GetService("Workspace").__THINGS.__INSTANCE_CONTAINER.Active.AdvancedDigsite.Important.ActiveBlocks:GetChildren()) do
                            if v2:IsA("BasePart") then
                                if v2 == v then
                                    block = v2
                                end
                            end
                        end

                        if block then
                            game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = block.CFrame + Vector3.new(0, 3, 0)
                            game:GetService("ReplicatedStorage").Network:WaitForChild("Instancing_FireCustomFromClient"):FireServer("AdvancedDigsite", "DigBlock", block:GetAttribute('Coord'))
                            task.wait()
                            counter = counter + 1
                            digBlock()
                        end

                    else
                        counter = 0
                    end
                end

                checkForChests()
                digBlock()
                task.wait()
            end
        end
    end
    digsiteReset = false
end



